
<!doctype html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width">
<title>Admin - User Management</title>
<link rel="stylesheet" href="css/style.css">
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
<script src="js/firebase_init.js"></script>
<script src="js/admin.js"></script>
</head><body class="theme-dark"><div class="app"><aside class="sidebar"><a class="icon" href="admin.html" title="Admin Panel">ğŸ› ï¸</a>
<!-- Admin & Friends Quick Links -->
<div style="margin-top:8px;display:flex;flex-direction:column;gap:6px">
  <a class="icon" href="friends.html" title="Friends">ğŸ‘¥</a>
  <a class="icon" href="requests.html" title="Requests">ğŸ“¨</a>
  <a id="adminQuick" class="icon" href="admin.html" title="Admin" style="display:none">âš™ï¸</a>
</div>
<script>
// show admin link if current user is admin (stored in localStorage ADMIN_EMAIL)
firebase && firebase.auth && firebase.auth().onAuthStateChanged(function(u){
  if(!u) return;
  var admin = (localStorage.getItem('ADMIN_EMAIL')||'proadmin@proton.me').trim().toLowerCase();
  if(u.email && u.email.trim().toLowerCase()===admin){
    var el = document.getElementById('adminQuick');
    if(el) el.style.display='inline-flex';
  }
});
</script>
<div class="logo"><img src="assets/server_logo.svg" style="width:48px;height:48px"></div><a class="icon" href="chat.html">ğŸ </a><a class="icon" href="dm.html">ğŸ’¬</a><a class="icon" href="friends.html">ğŸ‘¥</a><a class="icon" href="games.html">ğŸ®</a><a class="icon" href="notifications.html">ğŸ””</a></aside><div class="main"><div class="header"><div class="server-title">ChatPack</div></div><div class="content"><div class="channels" style="display:none"></div><div class="chat-area">
<header><a href="admin.html">Back</a> Admin - Users</header>
<main style="padding:20px"><div class="card" style="max-width:900px;margin:0 auto">
  <h3>Registered Users</h3>
  <div id="userList"></div>
</div></main>
<script>
firebase.auth().onAuthStateChanged(function(user){
  if(!user) return window.location.href='index.html';
  // ensure admin in admin.js already checked
  firebase.database().ref('users').once('value').then(function(snap){
    var out='';
    snap.forEach(function(ch){
      var u = ch.val(); out += '<div style="display:flex;gap:8px;align-items:center;"><img src="'+(u.pfp||'https://via.placeholder.com/48')+'" width=48 height=48><div><b>'+ (u.nickname || u.name || u.email) +'</b><div>'+ (u.email || '') +'</div></div><div><button onclick="banFromList(\''+ch.key+'\')">Ban</button> <button onclick="unbanFromList(\''+ch.key+'\')">Unban</button></div></div><hr>'; 
    });
    document.getElementById('userList').innerHTML = out;
  });
});

function banFromList(uid){
  firebase.database().ref('users/'+uid+'/email').once('value').then(function(s){ var e = s.val(); if(!e) return; var key = e.replace(/\./g,'_').toLowerCase(); firebase.database().ref('admin/ban/'+key).set(true); alert('Banned');});
}
function unbanFromList(uid){
  firebase.database().ref('users/'+uid+'/email').once('value').then(function(s){ var e = s.val(); if(!e) return; var key = e.replace(/\./g,'_').toLowerCase(); firebase.database().ref('admin/ban/'+key).remove(); alert('Unbanned');});
}
</script>

<!-- GLOBAL CUSTOMIZATION LOADER -->
<script>
(function(){
  const custom = JSON.parse(localStorage.getItem('siteCustom')||'{}');
  if(custom.bgUrl){ document.body.style.backgroundImage = `url(${custom.bgUrl})`; }
  if(custom.accentColor){
    document.documentElement.style.setProperty('--accent', custom.accentColor);
  }
  if(custom.logoUrl){
    const logo=document.querySelector('.site-logo');
    if(logo) logo.src=custom.logoUrl;
  }
  if(custom.siteTitle){
    const t=document.querySelector('.site-title');
    if(t) t.textContent=custom.siteTitle;
    document.title = custom.siteTitle;
  }
})();
</script>

</body></html>
</div></div></div></div>
<!-- GLOBAL CUSTOMIZATION LOADER -->
<script>
(function(){
  const custom = JSON.parse(localStorage.getItem('siteCustom')||'{}');
  if(custom.bgUrl){ document.body.style.backgroundImage = `url(${custom.bgUrl})`; }
  if(custom.accentColor){
    document.documentElement.style.setProperty('--accent', custom.accentColor);
  }
  if(custom.logoUrl){
    const logo=document.querySelector('.site-logo');
    if(logo) logo.src=custom.logoUrl;
  }
  if(custom.siteTitle){
    const t=document.querySelector('.site-title');
    if(t) t.textContent=custom.siteTitle;
    document.title = custom.siteTitle;
  }
})();
</script>

</body></html>